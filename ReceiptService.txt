*******************************************
RECEIPT SERVICE [ACTIVE-ACTIVE APPLICATION]
*******************************************
URLs:
Reston - receiptclusterrs.prod.wudip.com
Chicago - receiptclusterci.prod.wudip.com
Initial state: Balanced – Serves traffic in both Reston & Chicago DCs in the normal state
----------------------
TRAFFIC MOVEMENT STEPS
----------------------
1, Traffic movement for Receipt Service is done only in the LTM layer.

2, Traffic is moved by disabling the pool members having ‘higher priority group’ set in the respective LTM.
Ø  To move traffic to Chicago – Disable the Reston pool members in receiptclusterrs.prod.wudip.com
Ø  To move traffic to Reston - Disable the Chicago pool members in receiptclusterci.prod.wudip.com

3, Based on the DC in which the activity is planned or issue is observed, traffic has to be moved to the alternate DC for the respective DC URLs in the LTM layer.
Link to the automated job in rundeck to divert the traffic for the application is given below,
http://wuinfradeployment.wuintranet.net/project/ReceiptService-PROD/job/show/0d78a691-bf9b-4166-a972-6b51fd969e65

4, Post completion of the activity, traffic can be enabled back using the same job mentioned in Step 3.
Ø  To enable traffic in Reston – Enable the Reston pool members in receiptclusterrs.prod.wudip.com
Ø  To enable traffic in Chicago - Enable the Chicago pool members in receiptclusterci.prod.wudip.com

------------------------
NETWORK LAYER OPERATIONS
------------------------
It is an Active Active Application
It goes through LTM
LTM is the place where WEB or application serverxs are configured
Enabled both CHICAGO & RESTON servers at LTM thats why it is called active active application
Traffic will flow to the particular group based on Priority group value
Every request from reston URL will come to reston pool members in LTM
Inorder to move traffic to Chicago, Diable Reston pool members in Reston LTM, automatically, the traffic is taken by chicago.
It works along with WUPOS
----------------------------
APPLICATION LAYER OPERATIONS
----------------------------
Receipt is generated by this application
No receipt means transaction is incomplete
No web server
Only App server with JBOSS is used.
Version of JBOSS is Red Hat JBoss Enterprise Application Platform - Version 7.3.0.GA
It runs in Domain mode.
It has 5 process in 10.45.17.94 & 3 process in 10.45.17.95
Process includes Process Controller, Host Controller & jvm process.
Log Path: /apps/jboss7/jboss-eap-7.3/domain/servers/Receipts_prod_node1/log
Internally called by WUPOS at the end of the tranaction.
It is confighured in jetty conf of WUPOS Servers.
Database is SQL-DB

******
RESTON
******
Username: wuposadm
WUWVC9ASPOS33 	10.45.17.94
WUWVC9ASPOS34	10.45.17.95

*******
CHICAGO
*******
Username: wuposadm
WUWCC9ASPOS33	10.47.17.94
WUWCC9ASPOS34	10.47.17.95

************************************************************************************
CHG0270674-ACR JULY RELEASE_2 FOR ENHANCEMENTS FOR THE US,SINGAPORE AND PNG RECEIPTS
************************************************************************************
---------------------
ACTIVITY IN RESTON DC
---------------------
Initial Traffic Balanced --> Disable traffic in RESTON --> Take Backup of ReceiptPRodService directory --> Run the DB Scripts by SQL-DB --> Deploy the ReceiptPRodService using Spinnaker by Application Team --> Stop the JBOSS Services on both nodes using Rundeck --> Start the JBOSS Services on both nodes using Rundeck --> Log in to ROM Server 10.45.16.70 and take backup of chip.properties for both rom & rom-tablet --> Enable https://receiptclusterrsrom.prod.wudip.com/ReceiptServce/RcptSrv for both rom & rom-tablet-->  Restart jetty instances for both rom & rom-tablet --> TSC TEAM will perform the Sanity.
----------------------
ACTIVITY IN CHICAGO DC
----------------------
Enable Traffic in RESTON --> Disable Traffic in CHICAGO --> Take Backup of ReceiptPRodService directory --> Run the DB Scripts by SQL-DB --> Deploy the ReceiptPRodService using Spinnaker by Application Team --> Stop the JBOSS Services on both nodes using Rundeck --> Start the JBOSS Services on both nodes using Rundeck --> Log in to ROM Server 10.45.16.70 --> Disable https://receiptclusterrsrom.prod.wudip.com/ReceiptServce/RcptSrv for both rom & rom-tablet--> Enable https://receiptclustercirom.prod.wudip.com/ReceiptServce/RcptSrv for both rom & rom-tablet --> Restart jetty instances for both rom & rom-tablet --> TSC TEAM will perform the Sanity.

Revert the chip.properties files for both rom & rom-tablet and Restart both rom & rom-tablet 
DIRECTORY PATH --> /apps/jboss7/jboss-eap-7.3/modules/system/layers/base/com/microsoft/properties/main

***************
RECEIPT SERVICE
***************
----------------------------------------------------------------
To Start / Stop the services on APP Servers, Use the Rundeck job
----------------------------------------------------------------
Open Run Deck --> Search Receipts --> Select Receipts PROD --> Collapse All --> Select Resctart --> Select JBoss7.3_Restart [This job is to Restart Prod JBoss Receipt Servers] --> Select the appropriate job either START / STOP in the Activity --> Click Run Again --> Select the appropriate Data Center --> Select appropriate action [START / STOP] --> Click on Run Job Now 

--------------------------------------------------
WUPOS ROM APP SERVER USED FOR SANITY : 10.45.16.70
--------------------------------------------------
chip.properties is available at --> /apps/rom/wupos/conf
chip.properties is available at --> /apps/rom-tablet/wupos/conf
FETCH THE PROCESS --> ps -ef | grep /apps/rom/wupos/
ROM START OR STOP --> /apps/rom/wupos/jetty-9.3.23/bin/jetty.sh stop/start
FETCH THE PROCESS --> ps -ef | grep /apps/rom-tablet/wupos/
TABLET-ROM START OR STOP --> /apps/rom-tablet/wupos/jetty-9.4.13/bin/jetty.sh stop/start

Revert the chip.properties file to old one & restart ROM & ROM-tablet.

----------------------------------------------
JBOSS CONSOLE CREDENTIALS FOR RESTON & CHICAGO
----------------------------------------------
RESTON
http://10.45.17.94:9990/
CHICAGO
http://10.47.17.94:9990/
admin
jb@ss73d$V@dmin 

-----------
SANITY URLs --> To be Performed by WU TSC 
-----------
https://wuposrom.westernunion.com/agent-app/login
https://wuposlbrom-tablet.westernunion.com/tablet-ui/